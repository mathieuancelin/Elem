!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):"object"==typeof exports?exports.Elem=n():e.Elem=n()}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){function r(e){if(h.isUndefined(e))return"";var n=h.map(h.keys(e),function(n){var t=h.dasherize(n);"className"===n&&(t="class");var r=e[n];return!h.isUndefined(r)&&h.isFunction(r)&&(r=r()),h.isUndefined(r)?void 0:t+": "+r+";"});return n=h.filter(n,function(e){return!h.isUndefined(e)}),n.join(" ")}function o(e){if(h.isUndefined(e))return[];var n=h.map(h.keys(e),function(n){var t=e[n];return h.isUndefined(t)||t!==!0?void 0:h.dasherize(n)});return n=h.filter(n,function(e){return!h.isUndefined(e)})}function i(e){return 0===e?e:""===e?[]:e||[]}function u(e){return{getDOMNode:function(){return h.findNode('[data-nodeid="'+e+'"]')}}}function a(e,n,t){h.each(h.keys(e),function(r){var o=h.dasherize(r);h.startsWith(o,"on")&&t&&t.waitingHandlers&&t.waitingHandlers.push({root:t.root,id:n,event:o,callback:e[r]}),"ref"===o&&t&&t.refs&&(t.refs[e[r]]=u(n))})}function c(e,n){return{key:e,value:n}}function s(e){if(h.isUndefined(e))return[];var n=[];return h.each(h.keys(e),function(t){var i=h.dasherize(t);if("className"===t&&(i="class"),!h.startsWith(i,"on")&&"ref"!==i){var u=e[t];!h.isUndefined(u)&&h.isFunction(u)&&(u=u()),h.isUndefined(u)||n.push(h.isObject(u)&&"style"===i?c("style",r(u)):h.isArray(u)&&"class"===i?c(i,u.join(" ")):h.isObject(u)&&"class"===i?c(i,o(u).join(" ")):c(i,u))}}),n}function f(e,n,t){var r=h.uniqueId("node_");!h.isUndefined(t)||h.isUndefined(n)||n.__isAttrs||(t=n,n={}),e=h.escape(e)||"unknown",n=n||{},t=i(t),(h.isRegExp(t)||h.isUndefined(t)||h.isNull(t))&&(t=[]),h.isArray(t)&&(t=h.chain(t).map(function(e){return h.isFunction(e)?e():e}).filter(function(e){return!h.isUndefined(e)}).value());var o=h.contains(m.voidElements,e.toUpperCase())&&(h.isNull(t)||h.isUndefined(t)||h.isArray(t)&&0===t.length),u=s(n);return u.push(c("data-nodeid",h.escape(r))),m.debug&&u.push(c("title",h.escape(r))),{name:e,attrs:n,children:t,isElement:!0,nodeId:r,toJsonString:function(e){return e?JSON.stringify(this,null,2):JSON.stringify(this)},toHtmlNode:function(i,c){function s(e,n){if(h.isNumber(e))n.appendChild(i.createTextNode(e+""));else if(h.isString(e))n.appendChild(i.createTextNode(e));else if(h.isBoolean(e))n.appendChild(i.createTextNode(e+""));else if(h.isObject(e)&&e.isElement)n.appendChild(e.toHtmlNode(i,c));else if(h.isObject(e)&&e.__asHtml)n.innerHTML=e.__asHtml;else if(e.__componentFactory){var t=h.escape(h.uniqueId("component_")),r=i.createElement("span");r.setAttribute("data-componentid",t),n.appendChild(r),e.renderTo('[data-componentid="'+t+'"]')}else n.appendChild(i.createTextNode(e.toString()))}a(n,r,c);var f=i.createElement(h.escape(e));return h.each(u,function(e){f.setAttribute(e.key,e.value)}),o||(h.isArray(t)?h.each(t,function(e){s(e,f)}):s(t,f)),f}}}function l(e,n,t){return h.isFunction(e)&&(e=e((t||{props:{}}).props)),h.isUndefined(e)?[]:h.isArray(e)?h.chain(e).map(function(e){return h.isFunction(e)?e():e}).filter(function(e){return!h.isUndefined(e)}).map(function(e){return e.toHtmlNode(n,t)}).value():[e.toHtmlNode(n,t)]}var d,p,m=t(2),h=t(1),v=t(3),g=t(5),y=t(7).registerWebComponent,b=t(6),w=t(4);n.renderToString=function(e){m.markStart("Elem.renderToString");var n=h.map(l(e,b()),function(e){return e.toHtmlString()}).join("");return m.markStop("Elem.renderToString"),n},n.el=f,n.sel=function(e,n){return f(e,{},n)},n.vel=function(e,n){return f(e,n,[])},n.nbsp=function(e){return f("span",{__asHtml:h.times(e||1,function(){return"&nbsp;"})})},n.text=function(e){return f("span",{},e)},n.elements=function(){return h.map(arguments,function(e){return e})},n.render=function(e,n,t){m.markStart("Elem.render");var r=(t||{}).waitingHandlers||[],o=(t||{}).refs||{},i=(t||{}).props||{},u=document;if(n.ownerDocument&&(u=n.ownerDocument),h.isString(n)&&(n=u.querySelector(n)),!h.isUndefined(n)&&!h.isNull(n)){for(var a=l(e,u,{root:n,waitingHandlers:r,refs:o,props:i});!h.isUndefined(n)&&!h.isNull(n)&&n.firstChild;)n.removeChild(n.firstChild);h.each(a,function(e){h.isUndefined(n)||h.isNull(n)||n.appendChild(e)}),t&&t.__rootListener||h.each(r,function(e){h.on('[data-nodeid="'+e.id+'"]',[e.event.replace("on","")],function(){e.callback.apply({},arguments)})})}m.markStop("Elem.render")},n.component=v.component,n.componentFactory=v.componentFactory,n.state=g,n.Utils=h,n.registerWebComponent=y,n.dispatcher=w,n.Perf={start:function(){m.perfs=!0},stop:function(){m.stop=!1},markStart:m.markStart,markStop:m.markStop,collectMeasures:m.collectMeasures,printMeasures:m.printMeasures},n.predicate=function(e,n){return h.isFunction(e)?e()===!0?n:void 0:e===!0?n:void 0},n.p=n.predicate,n.ifPred=n.predicate,d=[],p=function(){return e.exports}.apply(n,d),!(void 0!==p&&(e.exports=p))},function(e,n){function t(e){if(!j(e))return[];if(Object.keys)return Object.keys(e);var n=[];for(var t in e)F(e,t)&&n.push(t);return n}function r(e){for(var n=n(e),t=n.length,r=Array(t),o=0;t>o;o++)r[o]=e[n[o]];return r}function o(e,n,t){if(null==e)return-1;var r=0,o=e.length;if(t){if("number"!=typeof t)return r=sortedIndex(e,n),e[r]===n?r:-1;r=0>t?Math.max(0,o+t):t}for(;o>r;r++)if(e[r]===n)return r;return-1}function i(e,n){if(null==e)return e;var t,r=e.length;if(r===+r)for(t=0;r>t;t++)n(e[t],t,e);else{var o=o(e);for(t=0,r=o.length;r>t;t++)n(e[o[t]],o[t],e)}return e}function u(e,n){if(null==e)return[];for(var t,r=e.length!==+e.length&&r(e),o=(r||e).length,i=Array(o),u=0;o>u;u++)t=r?r[u]:u,i[u]=n(e[t],t,e);return i}function a(e,n){var t=[];return null==e?t:(i(e,function(e,r,o){n(e,r,o)&&t.push(e)}),t)}function c(e,n,t){null==e&&(e=[]);var r,o=e.length!==+e.length&&o(e),i=(o||e).length,u=0;if(arguments.length<3){if(!i)throw new TypeError(reduceError);t=e[o?o[u++]:u++]}for(;i>u;u++)r=o?o[u]:u,t=n(t,e[r],r,e);return t}function s(e,n,t){return a(e,m(n),t)}function f(e,n){return a(e,l(n))}function l(e){var n=n(e),t=n.length;return function(e){if(null==e)return!t;e=new Object(e);for(var r=0;t>r;r++){var o=n[r],i=o[0];if(o[1]!==e[i]||!(i in e))return!1}return!0}}function d(e){return e}function p(e){return function(n){return n[e]}}function m(e){return function(){return!e.apply(this,arguments)}}function h(e){for(var n=n(e),t=n.length,r=Array(t),o=0;t>o;o++)r[o]=[n[o],e[n[o]]];return r}function v(e){function n(){return{value:function(){return t},map:function(e){return t=r.map(t,e),this},filter:function(e){return t=r.filter(t,e),this},each:function(e){return r.each(t,e),this},values:function(){return r.values()},keys:function(){return r.keys()},reduce:function(e,n,o){return r.reduce(t,e,n,o)},reject:function(e,n){return t=r.reject(t,e,n),this},where:function(e){return t=r.where(t,e),this}}}var t=e,r=this;return n()}function g(e,n){return null==e?!1:(e.length!==+e.length&&(e=r(e)),o(e,n)>=0)}function y(e){var n=++L+"";return e?e+n:n}function b(e,n){for(var t=[],r=0;e>r;r++)t.push(n(e));return t}function w(e){return j(e)?S(e)?e.slice():E({},e):e}function E(e){if(!j(e))return e;for(var n,t,r=1,o=arguments.length;o>r;r++){n=arguments[r];for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}function k(e){return void 0===e}function S(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function j(e){var n=typeof e;return"function"===n||"object"===n&&!!e}function A(e){return"[object Number]"===Object.prototype.toString.call(e)}function N(e){return"[object String]"===Object.prototype.toString.call(e)}function x(e){return e===!0||e===!1||"[object Boolean]"===Object.prototype.toString.call(e)}function _(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function O(e){return"[object Function]"===Object.prototype.toString.call(e)}function C(e){return null===e}function U(e){return A(e)&&e!==+e}function F(e,n){return null!=e&&Object.prototype.hasOwnProperty.call(e,n)}function M(e){return e.replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").toLowerCase().replace(/_/g,"-")}function R(e,n){return 0===e.indexOf(n)}function T(e){e.focus&&e.focus()}function H(e){return e===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(e.type||e.href||~e.tabIndex)}function q(e,n,t){var r=N(e)?document.querySelector(e):e;i(n,function(e){r&&null!==r&&(r.addEventListener?r.addEventListener(e,t,!1):r.attachEvent&&r.addEventListener(e,t))})}function B(){return document.querySelector(node)}var L=0,I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},z=function(e,n){var t=function(n){return e[n]},r="(?:"+n(e).join("|")+")",o=RegExp(r),i=RegExp(r,"g");return function(e){return e=null==e?"":""+e,o.test(e)?e.replace(i,t):e}};n.escape=z(I,t),n.keys=t,n.values=r,n.indexOf=o,n.each=i,n.map=u,n.filter=a,n.chain=v,n.contains=g,n.uniqueId=y,n.times=b,n.clone=w,n.extend=E,n.isUndefined=k,n.isArray=S,n.isObject=j,n.isNumber=A,n.isString=N,n.isBoolean=x,n.isRegExp=_,n.isFunction=O,n.isNull=C,n.isNaN=U,n.has=F,n.dasherize=M,n.startsWith=R,n.focus=T,n.hasFocus=H,n.on=q,n.findNode=B,n.reduce=c,n.reject=s,n.where=f,n.matches=l,n.negate=m,n.property=p,n.identity=d,n.pairs=h},function(e,n){n.debug=!1,n.perfs=!1,n.voidElements=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"],n.events=["wheel","scroll","touchcancel","touchend","touchmove","touchstart","click","doubleclick","drag","dragend","dragenter","dragexit","dragleave","dragover","dragstart","drop","change","input","submit","focus","blur","keydown","keypress","keyup","copy","cut","paste","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup"];var t={mark:function(){},measure:function(){},getEntriesByName:function(){return[]},getEntriesByType:function(){return[]},clearMarks:function(){},clearMeasures:function(){}};"undefined"!=typeof window.performance&&"undefined"!=typeof window.performance.mark&&"undefined"!=typeof window.performance.measure&&(t=window.performance),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(){return window.console&&console.error("No requestAnimationFrame, using lame polyfill ..."),function(e){window.setTimeout(e,1e3/60)}}();var r="ElemMeasureStart",o="ElemMeasureStop",i="ElemComponentRenderingMeasure",u=[i];n.markStart=function(e){n.perfs&&t.mark(e?e+"_start":r)},n.markStop=function(e){n.perfs&&(e?(t.mark(e+"_stop"),t.measure(e,e+"_start",e+"_stop"),_.contains(u,e)||u.push(e)):(t.mark(o),t.measure(i,r,o)))},n.collectMeasures=function(){if(!n.perfs)return[];var e=[];return _.each(u,function(n){e=e.concat(t.getEntriesByName(n))}),t.clearMarks(),t.clearMeasures(),u=[i],e},n.printMeasures=function(){n.perfs&&window.console&&console.table(n.collectMeasures())},n.defer=function(e){window.requestAnimationFrame.call(window,e)},n.defered=function(e){return function(){n.defer(e)}},Function.prototype.bind||(window.console&&console.error("No Function.prototype.bind, using polyfill ..."),Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - can't call bounded element");var n=Array.prototype.slice.call(arguments,1),t=this,r=function(){},o=function(){return t.apply(this instanceof r&&e?this:e,n.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,o.prototype=new r,o})},function(e,n,t){function r(e,n){return e.attributes&&e.attributes["data-"+n]}function o(e,n){return e.dataset?e.dataset[n]:e.attributes["data-"+n]}function i(e,n){function t(){a.markStart(i+".globalRendering"),c.each(d,function(e){delete l[e]}),d=[];var n=document.activeElement||{},t=n.dataset?n.dataset.key:(n.attributes||[]).key,r=[],o={};a.markStart(i+".render");var h=f(u,c.clone(s),{refs:o,getDOMNode:m});if(a.markStop(i+".render"),Elem.render(h,e,{waitingHandlers:r,__rootListener:!0,refs:o}),p(u,c.clone(s),{refs:o,getDOMNode:m}),t){var v=document.querySelector('[data-key="'+t+'"]');if(c.focus(v),v.value){var g=2*v.value.length;v.setSelectionRange(g,g)}}c.each(r,function(e){d.push(e.id+"_"+e.event.replace("on","")),l[e.id+"_"+e.event.replace("on","")]=function(){e.callback.apply({render:f},arguments)}}),a.markStop(i+".globalRendering")}var i=n.name||"Component",u=n.state||Elem.state(),s=n.props||{},f=n.render,l={},d=[],p=n.afterRender||function(){},m=function(){return c.findNode(e)};return n.init&&n.init(u,c.clone(s)),c.on(e,a.events,function(e){e=e||window.event;var n=e.target||e.srcElement,t=o(n,"nodeid")+"_"+e.type;if(l[t])l[t](e);else{for(;!l[t]&&n&&null!==n&&r(n,"nodeid");)n=n.parentElement,n&&null!==n&&r(n,"nodeid")&&(t=o(n,"nodeid")+"_"+e.type);l[t]&&l[t](e)}}),t(),u.onChange(t),u}function u(e){return function(n,t){var r={__componentFactory:!0,renderTo:function(t){var r=c.clone(e);r.props=c.extend(c.clone(e.props||{}),n||{}),a.defer(function(){i(t,r)})}};return t?r.renderTo(t):r}}var a=t(2),c=t(1);n.component=function(e){if(!e.container)return u(e);var n=e.container;i(n,e)}},function(e,n,t){var r=t(1),o=/\s+/;e.exports=function(){function e(e,t){var i=[e];o.test(e)&&(i=e.split(o)),r.each(i,function(e){r.each(n,function(n){"all"===n.name?n.callback(e,t):n.name===e&&n.callback(t)})})}var n=[];return{trigger:e,dispatch:e,on:function(e,t){this.off(e,t),n.push({name:e,callback:t})},off:function(e,t){n=r.filter(n,function(n){return n.name===e&&n.callback===t?!1:!0})}}}},function(e,n,t){var r=t(1);e.exports=function(e){function n(){r.each(o,function(e){e()})}var t=r.extend({},e||{}),o=[],i=function(){return r.clone(t)};return r.extend(i,{onChange:function(e){o.push(e)},get:function(e){return t[e]},all:function(){return r.clone(t)},forceUpdate:function(){n()},set:function(e,o){var i=r.isBoolean(o)&&o===!0;!r.isUndefined(e)&&r.isObject(e)&&(r.map(r.keys(e),function(n){t[n]=e[n]}),i||n(),i||(o||function(){})())},replace:function(e,n){t={},this.set(e,n)},remove:function(e){delete t[e],n()}})}},function(e,n,t){var r=t(2);e.exports=function(){function e(e){var n=[],t=[];return{setAttribute:function(e,t){n.push(e+'="'+t+'"')},appendChild:function(e){t.push(e)},toHtmlString:function(){var o=_.contains(r.voidElements,e.toUpperCase())&&0===t.length;return o?"<"+e+" "+n.join(" ")+" />":"<"+e+" "+n.join(" ")+">"+_.map(t,function(e){return e.toHtmlString()}).join("")+"</"+e+">"}}}return{createElement:e,createTextNode:function(e){return{toHtmlString:function(){return e}}}}}},function(e,n){function t(e,n){var t=document,o=Object.create(HTMLElement.prototype);o.createdCallback=function(){var e={};for(var r in this.attributes){var o=this.attributes[r];e[o.name]=o.value}this.props=e;var i=this;if("true"!==e.noshadow){var u=this.createShadowRoot();i=t.createElement("div"),i.setAttribute("class","elemcomponent"),u.appendChild(i)}this._node=i,this.renderedElement=e.renderOnly&&e.renderOnly===!0?Elem.render(n,i):Elem.component({container:i,init:n.init,render:n.render,props:e,state:n.state})},o.attributeChangedCallback=function(e,t,r){this.props[e]=r;var o=this.props;this.renderedElement=this.props.renderOnly&&this.props.renderOnly===!0?Elem.render(n,this._node):Elem.component({container:this._node,init:n.init,render:n.render,props:o,state:n.state})},r(e,{prototype:o})}var r=void 0;try{r=(document.registerElement||document.register||function(){window.console&&console.error("No registerElement function, webcomponents will not work !!!")}).bind(document)}catch(o){}n.registerWebComponent=r?t:function(){window.console&&console.error("WebComponent not available here :(")}}])});